<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Dotty Overall Structure</title><link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"></link><script type="text/javascript" src="../../scripts/clipboard.js" defer="true"></script><script type="text/javascript" src="../../scripts/platform-content-handler.js" defer="true"></script><script type="text/javascript" src="../../scripts/main.js" defer="true"></script><link rel="stylesheet" href="../../styles/nord-light.css"></link><link rel="stylesheet" href="../../styles/scalastyle.css"></link><link rel="stylesheet" href="../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../styles/diagram.css"></link><link rel="stylesheet" href="../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../styles/search-bar.css"></link><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><link rel="stylesheet" href="../../styles/filter-bar.css"></link><script type="text/javascript" src="../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../scripts/data.js" defer="true"></script><link rel="stylesheet" href="../../css/bootstrap.min.css"></link><link rel="stylesheet" href="../../css/dottydoc.css"></link><link rel="stylesheet" href="../../css/color-brewer.css"></link><script type="text/javascript" src="../../js/jquery.min.js" defer="true"></script><script type="text/javascript" src="../../js/bootstrap.min.js" defer="true"></script><script>var pathToRoot = "../../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><img src="../../project-logo/logo.svg"></img></span><span><div class="projectName">Scala 3</div></span><span><div class="projectVersion">3.0.0-RC1-bin-20201231-eb44b34-NIGHTLY</div></span></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="expanded"><a href="../../index.html">Scala 3</a><span></span><div><a href="../../blog/index.html">Blog</a><span></span><div><a href="../../blog/2020/12/18/scala3-m3.html">Scala 3.0.0-M3: developer&apos;s preview before RC1</a></div><div><a href="../../blog/2020/11/09/scala3-m1.html">Scala 3.0.0-M1 is here</a></div><div><a href="../../blog/2020/09/21/naming-schema-change.html">Dotty becomes Scala 3</a></div><div><a href="../../blog/2020/08/31/27th-dotty-milestone-release.html">Announcing Dotty 0.27.0-RC1 - ScalaJS, performance, stability</a></div><div><a href="../../blog/2020/07/27/26th-dotty-milestone-release.html">Announcing Dotty 0.26.0-RC1 - unified extension methods and more</a></div><div><a href="../../blog/2020/06/22/25th-dotty-milestone-release.html">Announcing Dotty 0.25.0-RC2 - speed-up of givens and change in the tuple API</a></div><div><a href="../../blog/2020/04/29/24th-dotty-milestone-release.html">Announcing Dotty 0.24.0-RC1 - 2.13.2 standard library, better error messages and more</a></div><div><a href="../../blog/2020/03/18/23rd-dotty-milestone-release.html">Announcing Dotty 0.23.0-RC1 - safe initialization checks, type-level bitwise operations and more</a></div><div><a href="../../blog/2020/02/05/22nd-dotty-milestone-release.html">Announcing Dotty 0.22.0-RC1 - syntactic enhancements, type-level arithmetic and more</a></div><div><a href="../../blog/2019/12/20/21th-dotty-milestone-release.html">Announcing Dotty 0.21.0-RC1 - explicit nulls, new syntax for `match` and conditional givens, and more</a></div><div><a href="../../blog/2019/11/04/20th-dotty-milestone-release.html">Announcing Dotty 0.20.0-RC1 – `with` starting indentation blocks, inline given specializations and more</a></div><div><a href="../../blog/2019/09/23/19th-dotty-milestone-release.html">Announcing Dotty 0.19.0-RC1 – further refinements of the syntax and the migration to 2.13.1 standard library</a></div><div><a href="../../blog/2019/08/30/18th-dotty-milestone-release.html">Announcing Dotty 0.18.1-RC1 – switch to the 2.13 standard library, indentation-based syntax and other experiments</a></div><div><a href="../../blog/2019/07/25/17th-dotty-milestone-release.html">Announcing Dotty 0.17.0-RC1 – new implicit scoping rules and more</a></div><div><a href="../../blog/2019/06/11/16th-dotty-milestone-release.html">Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</a></div><div><a href="../../blog/2019/05/23/15th-dotty-milestone-release.html">Announcing Dotty 0.15.0-RC1 – the fully bootstrapped compiler</a></div><div><a href="../../blog/2019/04/15/14th-dotty-milestone-release.html">Announcing Dotty 0.14.0-RC1 with export, immutable arrays, creator applications and more</a></div><div><a href="../../blog/2019/03/05/13th-dotty-milestone-release.html">Announcing Dotty 0.13.0-RC1 with Spark support, top level definitions and redesigned implicits</a></div><div><a href="../../blog/2019/01/21/12th-dotty-milestone-release.html">Announcing Dotty 0.12.0-RC1</a></div><div><a href="../../blog/2018/11/30/11th-dotty-milestone-release.html">Announcing Dotty 0.11.0-RC1</a></div><div><a href="../../blog/2018/10/10/10th-dotty-milestone-release.html">Announcing Dotty 0.10.0-RC1</a></div><div><a href="../../blog/2018/07/06/ninth-dotty-milestone-release.html">Announcing Dotty 0.9.0-RC1</a></div><div><a href="../../blog/2018/04/27/eighth-dotty-milestone-release.html">Announcing Dotty 0.7.0 and 0.8.0-RC1</a></div><div><a href="../../blog/2018/03/05/seventh-dotty-milestone-release.html">Announcing Dotty 0.6.0 and 0.7.0-RC1</a></div><div><a href="../../blog/2017/12/01/fifth-dotty-milestone-release.html">Announcing Dotty 0.5.0-RC1</a></div><div><a href="../../blog/2017/10/16/fourth-dotty-milestone-release.html">Announcing Dotty 0.4.0-RC1</a></div><div><a href="../../blog/2017/09/07/third-dotty-milestone-release.html">Announcing Dotty 0.3.0-RC2</a></div><div><a href="../../blog/2017/07/12/second-dotty-milestone-release.html">Announcing Dotty 0.2.0-RC1, with new optimizations, improved stability and IDE support</a></div><div><a href="../../blog/2017/05/31/first-dotty-milestone-release.html">Announcing Dotty 0.1.2-RC1, a major step towards Scala 3</a></div><div><a href="../../blog/2016/12/05/implicit-function-types.html">Implicit Function Types</a></div><div><a href="../../blog/2016/05/05/multiversal-equality.html">Multiversal Equality for Scala</a></div><div><a href="../../blog/2016/02/17/scaling-dot-soundness.html">Scaling DOT to Scala - Soundness</a></div><div><a href="../../blog/2016/02/03/essence-of-scala.html">The Essence of Scala</a></div><div><a href="../../blog/2016/01/02/new-year-resolutions.html">New Year Resolutions</a></div><div><a href="../../blog/2015/10/23/dotty-compiler-bootstraps.html">We got liftoff!</a></div></div><div><a href="../Usage/index.html">Usage</a><span></span><div><a href="../usage/getting-started.html">Getting Started: Users</a></div><div><a href="../usage/sbt-projects.html">Using Dotty with sbt</a></div><div><a href="../usage/ide-support.html">IDE support for Dotty</a></div><div><a href="../usage/worksheet-mode.html">Worksheet mode with Dotty IDE</a></div><div><a href="../usage/language-versions.html">Language Versions</a></div><div><a href="../usage/cbt-projects.html">Using Dotty with cbt</a></div><div><a href="../usage/scala3doc/index.html">Scala3doc</a><span></span><div><a href="../usage/scala3doc/blog.html">Built-in blog</a></div><div><a href="../usage/scala3doc/specificTags.html">Scala3doc-specific Tags and Features</a></div><div><a href="../usage/scala3doc/staticSite.html">Static documentation</a></div><div><a href="../usage/scala3doc/docComments.html">API Documentation</a></div></div><div><a href="../usage/dottydoc.html">Dottydoc [Legacy]</a></div></div><div><a href="../Reference/index.html">Reference</a><span></span><div><a href="../reference/overview.html">Overview</a></div><div><a href="../New Types/index.html">New Types</a><span></span><div><a href="../reference/new-types/intersection-types.html">Intersection Types</a></div><div><a href="../reference/new-types/union-types.html">Union Types</a></div><div><a href="../reference/new-types/type-lambdas.html">Type Lambdas</a></div><div><a href="../reference/new-types/match-types.html">Match Types</a></div><div><a href="../reference/new-types/dependent-function-types.html">Dependent Function Types</a></div><div><a href="../reference/new-types/polymorphic-function-types.html">Polymorphic Function Types</a></div></div><div><a href="../Enums/index.html">Enums</a><span></span><div><a href="../reference/enums/enums.html">Enumerations</a></div><div><a href="../reference/enums/adts.html">Algebraic Data Types</a></div><div><a href="../reference/enums/desugarEnums.html">Translation of Enums and ADTs</a></div></div><div><a href="../Contextual Abstractions/index.html">Contextual Abstractions</a><span></span><div><a href="../reference/contextual/motivation.html">Overview</a></div><div><a href="../reference/contextual/givens.html">Given Instances</a></div><div><a href="../reference/contextual/using-clauses.html">Using Clauses</a></div><div><a href="../reference/contextual/context-bounds.html">Context Bounds</a></div><div><a href="../reference/contextual/given-imports.html">Importing Givens</a></div><div><a href="../reference/contextual/extension-methods.html">Extension Methods</a></div><div><a href="../reference/contextual/type-classes.html">Implementing Type classes</a></div><div><a href="../reference/contextual/derivation.html">Type Class Derivation</a></div><div><a href="../reference/contextual/multiversal-equality.html">Multiversal Equality</a></div><div><a href="../reference/contextual/context-functions.html">Context Functions</a></div><div><a href="../reference/contextual/conversions.html">Implicit Conversions</a></div><div><a href="../reference/contextual/by-name-context-parameters.html">By-Name Context Parameters</a></div><div><a href="../reference/contextual/relationship-implicits.html">Relationship with Scala 2 Implicits</a></div></div><div><a href="../Metaprogramming/index.html">Metaprogramming</a><span></span><div><a href="../reference/metaprogramming/toc.html">Overview</a></div><div><a href="../reference/metaprogramming/inline.html">Inline</a></div><div><a href="../reference/metaprogramming/macros.html">Macros</a></div><div><a href="../reference/metaprogramming/staging.html">Multi-Stage Programming</a></div><div><a href="../reference/metaprogramming/tasty-reflect.html">TASTy Reflect</a></div><div><a href="../reference/metaprogramming/tasty-inspect.html">TASTy Inspection</a></div></div><div><a href="../Other New Features/index.html">Other New Features</a><span></span><div><a href="../reference/other-new-features/trait-parameters.html">Trait Parameters</a></div><div><a href="../reference/other-new-features/transparent-traits.html">Transparent Traits</a></div><div><a href="../reference/other-new-features/creator-applications.html">Universal Apply Methods</a></div><div><a href="../reference/other-new-features/export.html">Export Clauses</a></div><div><a href="../reference/other-new-features/opaques.html">Opaque Type Aliases</a></div><div><a href="../reference/other-new-features/open-classes.html">Open Classes</a></div><div><a href="../reference/other-new-features/parameter-untupling.html">Parameter Untupling</a></div><div><a href="../reference/other-new-features/kind-polymorphism.html">Kind Polymorphism</a></div><div><a href="../reference/other-new-features/matchable.html">The Matchable Trait</a></div><div><a href="../reference/other-new-features/threadUnsafe-annotation.html">threadUnsafe annotation</a></div><div><a href="../reference/other-new-features/targetName.html">The @targetName annotation</a></div><div><a href="../reference/other-new-features/control-syntax.html">New Control Syntax</a></div><div><a href="../reference/other-new-features/indentation.html">Optional Braces</a></div><div><a href="../reference/other-new-features/explicit-nulls.html">Explicit Nulls</a></div><div><a href="../reference/other-new-features/safe-initialization.html">Safe Initialization</a></div></div><div><a href="../Other Changed Features/index.html">Other Changed Features</a><span></span><div><a href="../reference/changed-features/numeric-literals.html">Numeric Literals</a></div><div><a href="../reference/changed-features/structural-types.html">Programmatic Structural Types</a></div><div><a href="../reference/changed-features/operators.html">Rules for Operators</a></div><div><a href="../reference/changed-features/wildcards.html">Wildcard Arguments in Types</a></div><div><a href="../reference/changed-features/type-checking.html">Changes in Type Checking</a></div><div><a href="../reference/changed-features/type-inference.html">Changes in Type Inference</a></div><div><a href="../reference/changed-features/implicit-resolution.html">Changes in Implicit Resolution</a></div><div><a href="../reference/changed-features/implicit-conversions.html">Implicit Conversions</a></div><div><a href="../reference/changed-features/overload-resolution.html">Changes in Overload Resolution</a></div><div><a href="../reference/changed-features/match-syntax.html">Match Expressions</a></div><div><a href="../reference/changed-features/vararg-patterns.html">Vararg Patterns</a></div><div><a href="../reference/changed-features/pattern-bindings.html">Pattern Bindings</a></div><div><a href="../reference/changed-features/pattern-matching.html">Option-less pattern matching</a></div><div><a href="../reference/changed-features/eta-expansion.html">Automatic Eta Expansion</a></div><div><a href="../reference/changed-features/compiler-plugins.html">Changes in Compiler Plugins</a></div><div><a href="../reference/changed-features/lazy-vals-init.html">Lazy Vals initialization</a></div><div><a href="../reference/changed-features/main-functions.html">Main Methods</a></div></div><div><a href="../Dropped Features/index.html">Dropped Features</a><span></span><div><a href="../reference/dropped-features/delayed-init.html">Dropped: Delayedinit</a></div><div><a href="../reference/dropped-features/macros.html">Dropped: Scala 2 Macros</a></div><div><a href="../reference/dropped-features/existential-types.html">Dropped: Existential Types</a></div><div><a href="../reference/dropped-features/type-projection.html">Dropped: General Type Projection</a></div><div><a href="../reference/dropped-features/do-while.html">Dropped: Do-While</a></div><div><a href="../reference/dropped-features/procedure-syntax.html">Dropped: Procedure Syntax</a></div><div><a href="../reference/dropped-features/package-objects.html">Dropped: Package Objects</a></div><div><a href="../reference/dropped-features/early-initializers.html">Dropped: Early Initializers</a></div><div><a href="../reference/dropped-features/class-shadowing.html">Dropped: Class Shadowing</a></div><div><a href="../reference/dropped-features/limit22.html">Dropped: Limit 22</a></div><div><a href="../reference/dropped-features/xml.html">Dropped: XML Literals</a></div><div><a href="../reference/dropped-features/symlits.html">Dropped: Symbol Literals</a></div><div><a href="../reference/dropped-features/auto-apply.html">Dropped: Auto-Application</a></div><div><a href="../reference/dropped-features/weak-conformance.html">Dropped: Weak Conformance</a></div><div><a href="../reference/dropped-features/nonlocal-returns.html">Deprecated: Nonlocal Returns</a></div><div><a href="../reference/dropped-features/this-qualifier.html">Dropped: private[this] and protected[this]</a></div></div><div><a href="../reference/syntax.html">Scala 3 Syntax Summary</a></div></div><div><a href="../Contributing/index.html">Contributing</a><span></span><div><a href="../contributing/contribute-knowledge.html">Contributing Knowledge</a></div><div><a href="../contributing/getting-started.html">Getting Started</a></div><div><a href="../contributing/workflow.html">Workflow</a></div><div><a href="../contributing/testing.html">Testing in Dotty</a></div><div><a href="../contributing/debugging.html">Debugging Techniques</a></div><div><a href="../IDEs and Tools/index.html">IDEs and Tools</a><span></span><div><a href="../contributing/tools/mill.html">Basic Operations with Mill</a></div><div><a href="../contributing/tools/scalafix.html">Working with Scalafix</a></div></div><div><a href="../Procedures/index.html">Procedures</a><span></span><div><a href="../contributing/procedures/release.html">Release Procedure</a></div><div><a href="../contributing/procedures/vulpix.html">Test Vulpix Framework</a></div></div></div><div class="expanded"><a href="../Internals/index.html">Internals</a><span></span><div><a href="backend.html">Backend Internals</a></div><div><a href="classpaths.html">Classpaths</a></div><div><a href="core-data-structures.html">Core Data Structures</a></div><div><a href="contexts.html">Contexts</a></div><div><a href="dotc-scalac.html">Differences between Scalac and Dotty</a></div><div><a href="higher-kinded-v2.html">Higher-Kinded Types in Dotty</a></div><div><a href="" class="selected expanded">Dotty Overall Structure</a></div><div><a href="periods.html">Dotc&apos;s concept of time</a></div><div><a href="syntax.html">Scala 3 Syntax Summary</a></div><div><a href="type-system.html">Type System</a></div><div><a href="dotty-internals-1-notes.html">Dotty Internals 1: Trees &amp; Symbols (Meeting Notes)</a></div><div><a href="debug-macros.html">Debug Macros</a></div></div><div><a href="../Resources/index.html">Resources</a><span></span><div><a href="../resources/talks.html">Talks</a></div></div><div><a href="../../api/index.html">API</a><span></span><div><a href="../../api/dotty/tools/tasty.html">dotty.tools.tasty</a></div><div><a href="../../api/dotty/tools/tasty/util.html">dotty.tools.tasty.util</a></div><div><a href="../../api/scala.html">scala</a></div><div><a href="../../api/scala/annotation.html">scala.annotation</a></div><div><a href="../../api/scala/annotation/meta.html">scala.annotation.meta</a></div><div><a href="../../api/scala/annotation/unchecked.html">scala.annotation.unchecked</a></div><div><a href="../../api/scala/beans.html">scala.beans</a></div><div><a href="../../api/scala/collection.html">scala.collection</a></div><div><a href="../../api/scala/collection/concurrent.html">scala.collection.concurrent</a></div><div><a href="../../api/scala/collection/convert.html">scala.collection.convert</a></div><div><a href="../../api/scala/collection/generic.html">scala.collection.generic</a></div><div><a href="../../api/scala/collection/immutable.html">scala.collection.immutable</a></div><div><a href="../../api/scala/collection/mutable.html">scala.collection.mutable</a></div><div><a href="../../api/scala/compat.html">scala.compat</a></div><div><a href="../../api/scala/compiletime.html">scala.compiletime</a></div><div><a href="../../api/scala/compiletime/ops.html">scala.compiletime.ops</a></div><div><a href="../../api/scala/compiletime/testing.html">scala.compiletime.testing</a></div><div><a href="../../api/scala/concurrent.html">scala.concurrent</a></div><div><a href="../../api/scala/concurrent/duration.html">scala.concurrent.duration</a></div><div><a href="../../api/scala/deriving.html">scala.deriving</a></div><div><a href="../../api/scala/io.html">scala.io</a></div><div><a href="../../api/scala/jdk.html">scala.jdk</a></div><div><a href="../../api/scala/jdk/javaapi.html">scala.jdk.javaapi</a></div><div><a href="../../api/scala/math.html">scala.math</a></div><div><a href="../../api/scala/quoted.html">scala.quoted</a></div><div><a href="../../api/scala/quoted/runtime.html">scala.quoted.runtime</a></div><div><a href="../../api/scala/ref.html">scala.ref</a></div><div><a href="../../api/scala/reflect.html">scala.reflect</a></div><div><a href="../../api/scala/reflect/macros.html">scala.reflect.macros</a></div><div><a href="../../api/scala/runtime.html">scala.runtime</a></div><div><a href="../../api/scala/runtime/java8.html">scala.runtime.java8</a></div><div><a href="../../api/scala/sys.html">scala.sys</a></div><div><a href="../../api/scala/sys/process.html">scala.sys.process</a></div><div><a href="../../api/scala/util.html">scala.util</a></div><div><a href="../../api/scala/util/control.html">scala.util.control</a></div><div><a href="../../api/scala/util/hashing.html">scala.util.hashing</a></div><div><a href="../../api/scala/util/matching.html">scala.util.matching</a></div></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="searchBar"></div><main>
  <div id="content" pageIds="docs.internals.overall-structure.md////PointingToDeclaration//-1734077091">
    <div class="breadcrumbs"><a href="../index.html">Scala 3</a>/<a href="../Internals/index.html">Internals</a>/<a href="">Dotty Overall Structure</a></div>
<html>
 <head>
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head>
 <body>
  <div id="content-wrapper"> 
   <main class="container"> 
    <header> 
     <h1>Dotty Overall Structure</h1> 
     <div class="byline"> <a href="https://github.com/lampepfl/dotty/edit/master/docs/docs/internals/overall-structure.md"> <i class="far fa-edit"></i> Edit this page on GitHub </a> 
     </div> 
    </header> 
    <p>The compiler code is found in package <a href="https://github.com/lampepfl/dotty/tree/master/compiler/src/dotty/tools">dotty.tools</a>. It spans the following three sub-packages:</p> 
    <pre><code>backend     Compiler backends (currently for JVM and JS)
   dotc     The main compiler
     io     Helper modules for file access and classpath handling.
</code></pre> 
    <p>The <a href="https://github.com/lampepfl/dotty/tree/master/compiler/src/dotty/tools/dotc">dotc</a> package contains some main classes that can be run as separate programs. The most important one is class <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/Main.scala">Main</a>. <code>Main</code> inherits from <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/Driver.scala">Driver</a> which contains the highest level functions for starting a compiler and processing some sources. <code>Driver</code> in turn is based on two other high-level classes, <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/Compiler.scala">Compiler</a> and <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/Run.scala">Run</a>.</p> 
    <h2><a href="#package-structure" id="package-structure" class="anchor"></a>Package Structure</h2> 
    <p>Most functionality of <code>scalac</code> is implemented in subpackages of <code>dotc</code>. Here's a list of sub-packages and their focus.</p> 
    <pre><code>.
├── ast                 // Abstract syntax trees
├── config              // Compiler configuration, settings, platform specific definitions.
├── core                // Core data structures and operations, with specific subpackages for:
│&nbsp;&nbsp; ├── classfile       // Reading of Java classfiles into core data structures
│&nbsp;&nbsp; ├── tasty           // Reading and writing of TASTY files to/from core data structures
│&nbsp;&nbsp; └── unpickleScala2  // Reading of Scala2 symbol information into core data structures
├── parsing             // Scanner and parser
├── printing            // Pretty-printing trees, types and other data
├── repl                // The interactive REPL
├── reporting           // Reporting of error messages, warnings and other info.
├── rewrites            // Helpers for rewriting Scala 2's constructs into dotty's.
├── semanticdb          // Helpers for exporting semanticdb from trees.
├── transform           // Miniphases and helpers for tree transformations.
├── typer               // Type-checking and other frontend phases
└── util                // General purpose utility classes and modules.
</code></pre> 
    <h2><a href="#contexts" id="contexts" class="anchor"></a>Contexts</h2> 
    <p><code>scalac</code> has almost no global state (the only significant bit of global state is the name table, which is used to hash strings into unique names). Instead, all essential bits of information that can vary over a compiler run are collected in a <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/core/Contexts.scala">Context</a>. Most methods in <code>scalac</code> take a <code>Context</code> value as an implicit parameter.</p> 
    <p>Contexts give a convenient way to customize values in some part of the call-graph. To run, e.g. some compiler function <code>f</code> at a given phase <code>phase</code>, we invoke <code>f</code> with an explicit context parameter, like this</p> 
    <pre><code class="language-scala">f(/*normal args*/)(using ctx.withPhase(phase))
</code></pre> 
    <p>This assumes that <code>f</code> is defined in the way most compiler functions are:</p> 
    <pre><code class="language-scala">def f(/*normal parameters*/)(implicit ctx: Context) ...
</code></pre> 
    <p>Compiler code follows the convention that all implicit <code>Context</code> parameters are named <code>ctx</code>. This is important to avoid implicit ambiguities in the case where nested methods contain each a Context parameters. The common name ensures then that the implicit parameters properly shadow each other.</p> 
    <p>Sometimes we want to make sure that implicit contexts are not captured in closures or other long-lived objects, be it because we want to enforce that nested methods each get their own implicit context, or because we want to avoid a space leak in the case where a closure can survive several compiler runs. A typical case is a completer for a symbol representing an external class, which produces the attributes of the symbol on demand, and which might never be invoked. In that case we follow the convention that any context parameter is explicit, not implicit, so we can track where it is used, and that it has a name different from <code>ctx</code>. Commonly used is <code>ictx</code> for "initialization context".</p> 
    <p>With these two conventions in place, it has turned out that implicit contexts work amazingly well as a device for dependency injection and bulk parameterization. There is of course always the danger that an unexpected implicit will be passed, but in practice this has not turned out to be much of a problem.</p> 
    <h2><a href="#compiler-phases" id="compiler-phases" class="anchor"></a>Compiler Phases</h2> 
    <p>Seen from a temporal perspective, the <code>scalac</code> compiler consists of a list of phases. The current list of phases is specified in class <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/Compiler.scala">Compiler</a> as follows:</p> 
    <pre><code class="language-scala">  def phases: List[List[Phase]] =
  frontendPhases ::: picklerPhases ::: transformPhases ::: backendPhases

  /** Phases dealing with the frontend up to trees ready for TASTY pickling */
  protected def frontendPhases: List[List[Phase]] =
    List(new FrontEnd) ::           // Compiler frontend: scanner, parser, namer, typer
    List(new YCheckPositions) ::    // YCheck positions
    List(new sbt.ExtractDependencies) :: // Sends information on classes' dependencies to sbt via callbacks
    List(new semanticdb.ExtractSemanticDB) :: // Extract info into .semanticdb files
    List(new PostTyper) ::          // Additional checks and cleanups after type checking
    List(new sjs.PrepJSInterop) ::  // Additional checks and transformations for Scala.js (Scala.js only)
    List(new Staging) ::            // Check PCP, heal quoted types and expand macros
    List(new sbt.ExtractAPI) ::     // Sends a representation of the API of classes to sbt via callbacks
    List(new SetRootTree) ::        // Set the `rootTreeOrProvider` on class symbols
    Nil

  /** Phases dealing with TASTY tree pickling and unpickling */
  protected def picklerPhases: List[List[Phase]] =
    List(new Pickler) ::            // Generate TASTY info
    List(new PickleQuotes) ::       // Turn quoted trees into explicit run-time data structures
    Nil

  /** Phases dealing with the transformation from pickled trees to backend trees */
  protected def transformPhases: List[List[Phase]] =
    List(new FirstTransform,         // Some transformations to put trees into a canonical form
         new CheckReentrant,         // Internal use only: Check that compiled program has no data races involving global vars
         new ElimPackagePrefixes,    // Eliminate references to package prefixes in Select nodes
         new CookComments,           // Cook the comments: expand variables, doc, etc.
         new CheckStatic,            // Check restrictions that apply to @static members
         new BetaReduce,             // Reduce closure applications
         new init.Checker) ::        // Check initialization of objects
    List(new ElimRepeated,           // Rewrite vararg parameters and arguments
         new ExpandSAMs,             // Expand single abstract method closures to anonymous classes
         new ProtectedAccessors,     // Add accessors for protected members
         new ExtensionMethods,       // Expand methods of value classes with extension methods
         new UncacheGivenAliases,    // Avoid caching RHS of simple parameterless given aliases
         new ByNameClosures,         // Expand arguments to by-name parameters to closures
         new HoistSuperArgs,         // Hoist complex arguments of supercalls to enclosing scope
         new SpecializeApplyMethods, // Adds specialized methods to FunctionN
         new RefChecks) ::           // Various checks mostly related to abstract members and overriding
    List(new ElimOpaque,             // Turn opaque into normal aliases
         new TryCatchPatterns,       // Compile cases in try/catch
         new PatternMatcher,         // Compile pattern matches
         new sjs.ExplicitJSClasses,  // Make all JS classes explicit (Scala.js only)
         new ExplicitOuter,          // Add accessors to outer classes from nested ones.
         new ExplicitSelf,           // Make references to non-trivial self types explicit as casts
         new ElimByName,             // Expand by-name parameter references
         new StringInterpolatorOpt) :: // Optimizes raw and s string interpolators by rewriting them to string concatentations
    List(new PruneErasedDefs,        // Drop erased definitions from scopes and simplify erased expressions
         new InlinePatterns,         // Remove placeholders of inlined patterns
         new VCInlineMethods,        // Inlines calls to value class methods
         new SeqLiterals,            // Express vararg arguments as arrays
         new InterceptedMethods,     // Special handling of `==`, `|=`, `getClass` methods
         new Getters,                // Replace non-private vals and vars with getter defs (fields are added later)
         new SpecializeFunctions,    // Specialized Function{0,1,2} by replacing super with specialized super
         new LiftTry,                // Put try expressions that might execute on non-empty stacks into their own methods
         new CollectNullableFields,  // Collect fields that can be nulled out after use in lazy initialization
         new ElimOuterSelect,        // Expand outer selections
         new ResolveSuper,           // Implement super accessors
         new FunctionXXLForwarders,  // Add forwarders for FunctionXXL apply method
         new ParamForwarding,        // Add forwarders for aliases of superclass parameters
         new TupleOptimizations,     // Optimize generic operations on tuples
         new LetOverApply,            // Lift blocks from receivers of applications
         new ArrayConstructors) ::   // Intercept creation of (non-generic) arrays and intrinsify.
    List(new Erasure) ::             // Rewrite types to JVM model, erasing all type parameters, abstract types and refinements.
    List(new ElimErasedValueType,    // Expand erased value types to their underlying implmementation types
         new PureStats,              // Remove pure stats from blocks
         new VCElideAllocations,     // Peep-hole optimization to eliminate unnecessary value class allocations
         new ArrayApply,             // Optimize `scala.Array.apply([....])` and `scala.Array.apply(..., [....])` into `[...]`
         new sjs.AddLocalJSFakeNews, // Adds fake new invocations to local JS classes in calls to `createLocalJSClass`
         new ElimPolyFunction,       // Rewrite PolyFunction subclasses to FunctionN subclasses
         new TailRec,                // Rewrite tail recursion to loops
         new CompleteJavaEnums,      // Fill in constructors for Java enums
         new Mixin,                  // Expand trait fields and trait initializers
         new LazyVals,               // Expand lazy vals
         new Memoize,                // Add private fields to getters and setters
         new NonLocalReturns,        // Expand non-local returns
         new CapturedVars) ::        // Represent vars captured by closures as heap objects
    List(new Constructors,           // Collect initialization code in primary constructors
                                        // Note: constructors changes decls in transformTemplate, no InfoTransformers should be added after it
         new Instrumentation) ::     // Count calls and allocations under -Yinstrument
    List(new LambdaLift,             // Lifts out nested functions to class scope, storing free variables in environments
                                     // Note: in this mini-phase block scopes are incorrect. No phases that rely on scopes should be here
         new ElimStaticThis,         // Replace `this` references to static objects by global identifiers
         new CountOuterAccesses) ::  // Identify outer accessors that can be dropped
    List(new DropOuterAccessors,     // Drop unused outer accessors
         new Flatten,                // Lift all inner classes to package scope
         new RenameLifted,           // Renames lifted classes to local numbering scheme
         new TransformWildcards,     // Replace wildcards with default values
         new MoveStatics,            // Move static methods from companion to the class itself
         new ExpandPrivate,          // Widen private definitions accessed from nested classes
         new RestoreScopes,          // Repair scopes rendered invalid by moving definitions in prior phases of the group
         new SelectStatic,           // get rid of selects that would be compiled into GetStatic
         new sjs.JUnitBootstrappers, // Generate JUnit-specific bootstrapper classes for Scala.js (not enabled by default)
         new CollectSuperCalls) ::   // Find classes that are called with super
    Nil

  /** Generate the output of the compilation */
  protected def backendPhases: List[List[Phase]] =
    List(new backend.sjs.GenSJSIR) :: // Generate .sjsir files for Scala.js (not enabled by default)
    List(new GenBCode) ::             // Generate JVM bytecode
    Nil
</code></pre> 
    <p>Note that phases are grouped, so the <code>phases</code> method is of type <code>List[List[Phase]]</code>. The idea is that all phases in a group are <em>fused</em> into a single tree traversal. That way, phases can be kept small (most phases perform a single function) without requiring an excessive number of tree traversals (which are costly, because they have generally bad cache locality).</p> 
    <p>Phases fall into four categories:</p> 
    <ul> 
     <li> <p>Frontend phases: <code>Frontend</code>, <code>PostTyper</code> and <code>Pickler</code>. <code>FrontEnd</code> parses the source programs and generates untyped abstract syntax trees, which are then typechecked and transformed into typed abstract syntax trees. <code>PostTyper</code> performs checks and cleanups that require a fully typed program. In particular, it</p> 
      <ul> 
       <li>creates super accessors representing <code>super</code> calls in traits</li> 
       <li>creates implementations of synthetic (compiler-implemented) methods</li> 
       <li>avoids storing parameters passed unchanged from subclass to superclass in duplicate fields.</li> 
      </ul> <p>Finally <code>Pickler</code> serializes the typed syntax trees produced by the frontend as TASTY data structures.</p> </li> 
     <li> <p>High-level transformations: All phases from <code>FirstTransform</code> to <code>Erasure</code>. Most of these phases transform syntax trees, expanding high-level constructs to more primitive ones. The last phase in the group, <code>Erasure</code> translates all types into types supported directly by the JVM. To do this, it performs another type checking pass, but using the rules of the JVM's type system instead of Scala's.</p> </li> 
     <li> <p>Low-level transformations: All phases from <code>ElimErasedValueType</code> to <code>CollectSuperCalls</code>. These further transform trees until they are essentially a structured version of Java bytecode.</p> </li> 
     <li>Code generators: These map the transformed trees to Java classfiles or .sjsir files.</li> 
    </ul> 
   </main> 
  </div> 
  <script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'lampepfl/dotty'
  };
</script> 
  <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
 </body>
</html>  </div>
</main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span>Generated by&nbsp;<a href="https://github.com/lampepfl/dotty/tree/master/scala3doc"><img src="../../images/scala3doc_logo.svg" alt="Scala3doc" class="scala3doc_logo"></img></a></footer></div></div><script type="text/javascript" src="../../scripts/pages.js"></script><script type="text/javascript" src="../../scripts/main.js"></script></body></html>
