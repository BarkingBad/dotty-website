<html><head><meta charset="utf-8"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><title>Debugging Techniques</title><link rel="shortcut icon" type="image/x-icon" href="../../favicon.ico"></link><script type="text/javascript" src="../../scripts/clipboard.js" defer="true"></script><script type="text/javascript" src="../../scripts/platform-content-handler.js" defer="true"></script><script type="text/javascript" src="../../scripts/main.js" defer="true"></script><link rel="stylesheet" href="../../styles/nord-light.css"></link><link rel="stylesheet" href="../../styles/scalastyle.css"></link><link rel="stylesheet" href="../../styles/dotty-icons.css"></link><link rel="stylesheet" href="../../styles/diagram.css"></link><link rel="stylesheet" href="../../styles/filter-bar.css"></link><link rel="stylesheet" href="../../styles/search-bar.css"></link><script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.min.js" defer="true"></script><script type="text/javascript" src="https://d3js.org/d3.v6.min.js" defer="true"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/graphlib-dot@0.6.2/dist/graphlib-dot.min.js" defer="true"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.6.1/dagre-d3.min.js" defer="true"></script><link rel="stylesheet" href="../../styles/filter-bar.css"></link><script type="text/javascript" src="../../hljs/highlight.pack.js" defer="true"></script><script type="text/javascript" src="../../scripts/hljs-scala3.js" defer="true"></script><script type="text/javascript" src="../../scripts/ux.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/component.js" defer="true"></script><script type="text/javascript" src="../../scripts/common/utils.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterBar.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/DocumentableList.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Input.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/FilterGroup.js" defer="true"></script><script type="text/javascript" src="../../scripts/components/Filter.js" defer="true"></script><script type="text/javascript" src="../../scripts/data.js" defer="true"></script><link rel="stylesheet" href="../../css/bootstrap.min.css"></link><link rel="stylesheet" href="../../css/dottydoc.css"></link><link rel="stylesheet" href="../../css/color-brewer.css"></link><script type="text/javascript" src="../../js/jquery.min.js" defer="true"></script><script type="text/javascript" src="../../js/bootstrap.min.js" defer="true"></script><script>var pathToRoot = "../../";</script></head><body><div id="container"><div id="leftColumn"><div id="logo"><span><img src="../../project-logo/logo.svg"></img></span><span><div class="projectName">Scala 3</div></span><span><div class="projectVersion">3.0.0-RC1-bin-20201230-0a8bb4b-NIGHTLY</div></span></div><div id="paneSearch"></div><nav id="sideMenu2"><div class="expanded"><a href="../../index.html">Scala 3</a><span></span><div><a href="../../blog/index.html">Blog</a><span></span><div><a href="../../blog/2020/12/18/scala3-m3.html">Scala 3.0.0-M3: developer&apos;s preview before RC1</a></div><div><a href="../../blog/2020/11/09/scala3-m1.html">Scala 3.0.0-M1 is here</a></div><div><a href="../../blog/2020/09/21/naming-schema-change.html">Dotty becomes Scala 3</a></div><div><a href="../../blog/2020/08/31/27th-dotty-milestone-release.html">Announcing Dotty 0.27.0-RC1 - ScalaJS, performance, stability</a></div><div><a href="../../blog/2020/07/27/26th-dotty-milestone-release.html">Announcing Dotty 0.26.0-RC1 - unified extension methods and more</a></div><div><a href="../../blog/2020/06/22/25th-dotty-milestone-release.html">Announcing Dotty 0.25.0-RC2 - speed-up of givens and change in the tuple API</a></div><div><a href="../../blog/2020/04/29/24th-dotty-milestone-release.html">Announcing Dotty 0.24.0-RC1 - 2.13.2 standard library, better error messages and more</a></div><div><a href="../../blog/2020/03/18/23rd-dotty-milestone-release.html">Announcing Dotty 0.23.0-RC1 - safe initialization checks, type-level bitwise operations and more</a></div><div><a href="../../blog/2020/02/05/22nd-dotty-milestone-release.html">Announcing Dotty 0.22.0-RC1 - syntactic enhancements, type-level arithmetic and more</a></div><div><a href="../../blog/2019/12/20/21th-dotty-milestone-release.html">Announcing Dotty 0.21.0-RC1 - explicit nulls, new syntax for `match` and conditional givens, and more</a></div><div><a href="../../blog/2019/11/04/20th-dotty-milestone-release.html">Announcing Dotty 0.20.0-RC1 – `with` starting indentation blocks, inline given specializations and more</a></div><div><a href="../../blog/2019/09/23/19th-dotty-milestone-release.html">Announcing Dotty 0.19.0-RC1 – further refinements of the syntax and the migration to 2.13.1 standard library</a></div><div><a href="../../blog/2019/08/30/18th-dotty-milestone-release.html">Announcing Dotty 0.18.1-RC1 – switch to the 2.13 standard library, indentation-based syntax and other experiments</a></div><div><a href="../../blog/2019/07/25/17th-dotty-milestone-release.html">Announcing Dotty 0.17.0-RC1 – new implicit scoping rules and more</a></div><div><a href="../../blog/2019/06/11/16th-dotty-milestone-release.html">Announcing Dotty 0.16.0-RC3 – the Scala Days 2019 Release</a></div><div><a href="../../blog/2019/05/23/15th-dotty-milestone-release.html">Announcing Dotty 0.15.0-RC1 – the fully bootstrapped compiler</a></div><div><a href="../../blog/2019/04/15/14th-dotty-milestone-release.html">Announcing Dotty 0.14.0-RC1 with export, immutable arrays, creator applications and more</a></div><div><a href="../../blog/2019/03/05/13th-dotty-milestone-release.html">Announcing Dotty 0.13.0-RC1 with Spark support, top level definitions and redesigned implicits</a></div><div><a href="../../blog/2019/01/21/12th-dotty-milestone-release.html">Announcing Dotty 0.12.0-RC1</a></div><div><a href="../../blog/2018/11/30/11th-dotty-milestone-release.html">Announcing Dotty 0.11.0-RC1</a></div><div><a href="../../blog/2018/10/10/10th-dotty-milestone-release.html">Announcing Dotty 0.10.0-RC1</a></div><div><a href="../../blog/2018/07/06/ninth-dotty-milestone-release.html">Announcing Dotty 0.9.0-RC1</a></div><div><a href="../../blog/2018/04/27/eighth-dotty-milestone-release.html">Announcing Dotty 0.7.0 and 0.8.0-RC1</a></div><div><a href="../../blog/2018/03/05/seventh-dotty-milestone-release.html">Announcing Dotty 0.6.0 and 0.7.0-RC1</a></div><div><a href="../../blog/2017/12/01/fifth-dotty-milestone-release.html">Announcing Dotty 0.5.0-RC1</a></div><div><a href="../../blog/2017/10/16/fourth-dotty-milestone-release.html">Announcing Dotty 0.4.0-RC1</a></div><div><a href="../../blog/2017/09/07/third-dotty-milestone-release.html">Announcing Dotty 0.3.0-RC2</a></div><div><a href="../../blog/2017/07/12/second-dotty-milestone-release.html">Announcing Dotty 0.2.0-RC1, with new optimizations, improved stability and IDE support</a></div><div><a href="../../blog/2017/05/31/first-dotty-milestone-release.html">Announcing Dotty 0.1.2-RC1, a major step towards Scala 3</a></div><div><a href="../../blog/2016/12/05/implicit-function-types.html">Implicit Function Types</a></div><div><a href="../../blog/2016/05/05/multiversal-equality.html">Multiversal Equality for Scala</a></div><div><a href="../../blog/2016/02/17/scaling-dot-soundness.html">Scaling DOT to Scala - Soundness</a></div><div><a href="../../blog/2016/02/03/essence-of-scala.html">The Essence of Scala</a></div><div><a href="../../blog/2016/01/02/new-year-resolutions.html">New Year Resolutions</a></div><div><a href="../../blog/2015/10/23/dotty-compiler-bootstraps.html">We got liftoff!</a></div></div><div><a href="../Usage/index.html">Usage</a><span></span><div><a href="../usage/getting-started.html">Getting Started: Users</a></div><div><a href="../usage/sbt-projects.html">Using Dotty with sbt</a></div><div><a href="../usage/ide-support.html">IDE support for Dotty</a></div><div><a href="../usage/worksheet-mode.html">Worksheet mode with Dotty IDE</a></div><div><a href="../usage/language-versions.html">Language Versions</a></div><div><a href="../usage/cbt-projects.html">Using Dotty with cbt</a></div><div><a href="../usage/scala3doc/index.html">Scala3doc</a><span></span><div><a href="../usage/scala3doc/blog.html">Built-in blog</a></div><div><a href="../usage/scala3doc/specificTags.html">Scala3doc-specific Tags and Features</a></div><div><a href="../usage/scala3doc/staticSite.html">Static documentation</a></div><div><a href="../usage/scala3doc/docComments.html">API Documentation</a></div></div><div><a href="../usage/dottydoc.html">Dottydoc [Legacy]</a></div></div><div><a href="../Reference/index.html">Reference</a><span></span><div><a href="../reference/overview.html">Overview</a></div><div><a href="../New Types/index.html">New Types</a><span></span><div><a href="../reference/new-types/intersection-types.html">Intersection Types</a></div><div><a href="../reference/new-types/union-types.html">Union Types</a></div><div><a href="../reference/new-types/type-lambdas.html">Type Lambdas</a></div><div><a href="../reference/new-types/match-types.html">Match Types</a></div><div><a href="../reference/new-types/dependent-function-types.html">Dependent Function Types</a></div><div><a href="../reference/new-types/polymorphic-function-types.html">Polymorphic Function Types</a></div></div><div><a href="../Enums/index.html">Enums</a><span></span><div><a href="../reference/enums/enums.html">Enumerations</a></div><div><a href="../reference/enums/adts.html">Algebraic Data Types</a></div><div><a href="../reference/enums/desugarEnums.html">Translation of Enums and ADTs</a></div></div><div><a href="../Contextual Abstractions/index.html">Contextual Abstractions</a><span></span><div><a href="../reference/contextual/motivation.html">Overview</a></div><div><a href="../reference/contextual/givens.html">Given Instances</a></div><div><a href="../reference/contextual/using-clauses.html">Using Clauses</a></div><div><a href="../reference/contextual/context-bounds.html">Context Bounds</a></div><div><a href="../reference/contextual/given-imports.html">Importing Givens</a></div><div><a href="../reference/contextual/extension-methods.html">Extension Methods</a></div><div><a href="../reference/contextual/type-classes.html">Implementing Type classes</a></div><div><a href="../reference/contextual/derivation.html">Type Class Derivation</a></div><div><a href="../reference/contextual/multiversal-equality.html">Multiversal Equality</a></div><div><a href="../reference/contextual/context-functions.html">Context Functions</a></div><div><a href="../reference/contextual/conversions.html">Implicit Conversions</a></div><div><a href="../reference/contextual/by-name-context-parameters.html">By-Name Context Parameters</a></div><div><a href="../reference/contextual/relationship-implicits.html">Relationship with Scala 2 Implicits</a></div></div><div><a href="../Metaprogramming/index.html">Metaprogramming</a><span></span><div><a href="../reference/metaprogramming/toc.html">Overview</a></div><div><a href="../reference/metaprogramming/inline.html">Inline</a></div><div><a href="../reference/metaprogramming/macros.html">Macros</a></div><div><a href="../reference/metaprogramming/staging.html">Multi-Stage Programming</a></div><div><a href="../reference/metaprogramming/tasty-reflect.html">TASTy Reflect</a></div><div><a href="../reference/metaprogramming/tasty-inspect.html">TASTy Inspection</a></div></div><div><a href="../Other New Features/index.html">Other New Features</a><span></span><div><a href="../reference/other-new-features/trait-parameters.html">Trait Parameters</a></div><div><a href="../reference/other-new-features/transparent-traits.html">Transparent Traits</a></div><div><a href="../reference/other-new-features/creator-applications.html">Universal Apply Methods</a></div><div><a href="../reference/other-new-features/export.html">Export Clauses</a></div><div><a href="../reference/other-new-features/opaques.html">Opaque Type Aliases</a></div><div><a href="../reference/other-new-features/open-classes.html">Open Classes</a></div><div><a href="../reference/other-new-features/parameter-untupling.html">Parameter Untupling</a></div><div><a href="../reference/other-new-features/kind-polymorphism.html">Kind Polymorphism</a></div><div><a href="../reference/other-new-features/matchable.html">The Matchable Trait</a></div><div><a href="../reference/other-new-features/threadUnsafe-annotation.html">threadUnsafe annotation</a></div><div><a href="../reference/other-new-features/targetName.html">The @targetName annotation</a></div><div><a href="../reference/other-new-features/control-syntax.html">New Control Syntax</a></div><div><a href="../reference/other-new-features/indentation.html">Optional Braces</a></div><div><a href="../reference/other-new-features/explicit-nulls.html">Explicit Nulls</a></div><div><a href="../reference/other-new-features/safe-initialization.html">Safe Initialization</a></div></div><div><a href="../Other Changed Features/index.html">Other Changed Features</a><span></span><div><a href="../reference/changed-features/numeric-literals.html">Numeric Literals</a></div><div><a href="../reference/changed-features/structural-types.html">Programmatic Structural Types</a></div><div><a href="../reference/changed-features/operators.html">Rules for Operators</a></div><div><a href="../reference/changed-features/wildcards.html">Wildcard Arguments in Types</a></div><div><a href="../reference/changed-features/type-checking.html">Changes in Type Checking</a></div><div><a href="../reference/changed-features/type-inference.html">Changes in Type Inference</a></div><div><a href="../reference/changed-features/implicit-resolution.html">Changes in Implicit Resolution</a></div><div><a href="../reference/changed-features/implicit-conversions.html">Implicit Conversions</a></div><div><a href="../reference/changed-features/overload-resolution.html">Changes in Overload Resolution</a></div><div><a href="../reference/changed-features/match-syntax.html">Match Expressions</a></div><div><a href="../reference/changed-features/vararg-patterns.html">Vararg Patterns</a></div><div><a href="../reference/changed-features/pattern-bindings.html">Pattern Bindings</a></div><div><a href="../reference/changed-features/pattern-matching.html">Option-less pattern matching</a></div><div><a href="../reference/changed-features/eta-expansion.html">Automatic Eta Expansion</a></div><div><a href="../reference/changed-features/compiler-plugins.html">Changes in Compiler Plugins</a></div><div><a href="../reference/changed-features/lazy-vals-init.html">Lazy Vals initialization</a></div><div><a href="../reference/changed-features/main-functions.html">Main Methods</a></div></div><div><a href="../Dropped Features/index.html">Dropped Features</a><span></span><div><a href="../reference/dropped-features/delayed-init.html">Dropped: Delayedinit</a></div><div><a href="../reference/dropped-features/macros.html">Dropped: Scala 2 Macros</a></div><div><a href="../reference/dropped-features/existential-types.html">Dropped: Existential Types</a></div><div><a href="../reference/dropped-features/type-projection.html">Dropped: General Type Projection</a></div><div><a href="../reference/dropped-features/do-while.html">Dropped: Do-While</a></div><div><a href="../reference/dropped-features/procedure-syntax.html">Dropped: Procedure Syntax</a></div><div><a href="../reference/dropped-features/package-objects.html">Dropped: Package Objects</a></div><div><a href="../reference/dropped-features/early-initializers.html">Dropped: Early Initializers</a></div><div><a href="../reference/dropped-features/class-shadowing.html">Dropped: Class Shadowing</a></div><div><a href="../reference/dropped-features/limit22.html">Dropped: Limit 22</a></div><div><a href="../reference/dropped-features/xml.html">Dropped: XML Literals</a></div><div><a href="../reference/dropped-features/symlits.html">Dropped: Symbol Literals</a></div><div><a href="../reference/dropped-features/auto-apply.html">Dropped: Auto-Application</a></div><div><a href="../reference/dropped-features/weak-conformance.html">Dropped: Weak Conformance</a></div><div><a href="../reference/dropped-features/nonlocal-returns.html">Deprecated: Nonlocal Returns</a></div><div><a href="../reference/dropped-features/this-qualifier.html">Dropped: private[this] and protected[this]</a></div></div><div><a href="../reference/syntax.html">Scala 3 Syntax Summary</a></div></div><div class="expanded"><a href="../Contributing/index.html">Contributing</a><span></span><div><a href="contribute-knowledge.html">Contributing Knowledge</a></div><div><a href="getting-started.html">Getting Started</a></div><div><a href="workflow.html">Workflow</a></div><div><a href="testing.html">Testing in Dotty</a></div><div><a href="" class="selected expanded">Debugging Techniques</a></div><div><a href="../IDEs and Tools/index.html">IDEs and Tools</a><span></span><div><a href="tools/mill.html">Basic Operations with Mill</a></div><div><a href="tools/scalafix.html">Working with Scalafix</a></div></div><div><a href="../Procedures/index.html">Procedures</a><span></span><div><a href="procedures/release.html">Release Procedure</a></div><div><a href="procedures/vulpix.html">Test Vulpix Framework</a></div></div></div><div><a href="../Internals/index.html">Internals</a><span></span><div><a href="../internals/backend.html">Backend Internals</a></div><div><a href="../internals/classpaths.html">Classpaths</a></div><div><a href="../internals/core-data-structures.html">Core Data Structures</a></div><div><a href="../internals/contexts.html">Contexts</a></div><div><a href="../internals/dotc-scalac.html">Differences between Scalac and Dotty</a></div><div><a href="../internals/higher-kinded-v2.html">Higher-Kinded Types in Dotty</a></div><div><a href="../internals/overall-structure.html">Dotty Overall Structure</a></div><div><a href="../internals/periods.html">Dotc&apos;s concept of time</a></div><div><a href="../internals/syntax.html">Scala 3 Syntax Summary</a></div><div><a href="../internals/type-system.html">Type System</a></div><div><a href="../internals/dotty-internals-1-notes.html">Dotty Internals 1: Trees &amp; Symbols (Meeting Notes)</a></div><div><a href="../internals/debug-macros.html">Debug Macros</a></div></div><div><a href="../Resources/index.html">Resources</a><span></span><div><a href="../resources/talks.html">Talks</a></div></div><div><a href="../../api/index.html">API</a><span></span><div><a href="../../api/dotty/tools/tasty.html">dotty.tools.tasty</a></div><div><a href="../../api/dotty/tools/tasty/util.html">dotty.tools.tasty.util</a></div><div><a href="../../api/scala.html">scala</a></div><div><a href="../../api/scala/annotation.html">scala.annotation</a></div><div><a href="../../api/scala/annotation/meta.html">scala.annotation.meta</a></div><div><a href="../../api/scala/annotation/unchecked.html">scala.annotation.unchecked</a></div><div><a href="../../api/scala/beans.html">scala.beans</a></div><div><a href="../../api/scala/collection.html">scala.collection</a></div><div><a href="../../api/scala/collection/concurrent.html">scala.collection.concurrent</a></div><div><a href="../../api/scala/collection/convert.html">scala.collection.convert</a></div><div><a href="../../api/scala/collection/generic.html">scala.collection.generic</a></div><div><a href="../../api/scala/collection/immutable.html">scala.collection.immutable</a></div><div><a href="../../api/scala/collection/mutable.html">scala.collection.mutable</a></div><div><a href="../../api/scala/compat.html">scala.compat</a></div><div><a href="../../api/scala/compiletime.html">scala.compiletime</a></div><div><a href="../../api/scala/compiletime/ops.html">scala.compiletime.ops</a></div><div><a href="../../api/scala/compiletime/testing.html">scala.compiletime.testing</a></div><div><a href="../../api/scala/concurrent.html">scala.concurrent</a></div><div><a href="../../api/scala/concurrent/duration.html">scala.concurrent.duration</a></div><div><a href="../../api/scala/deriving.html">scala.deriving</a></div><div><a href="../../api/scala/io.html">scala.io</a></div><div><a href="../../api/scala/jdk.html">scala.jdk</a></div><div><a href="../../api/scala/jdk/javaapi.html">scala.jdk.javaapi</a></div><div><a href="../../api/scala/math.html">scala.math</a></div><div><a href="../../api/scala/quoted.html">scala.quoted</a></div><div><a href="../../api/scala/quoted/runtime.html">scala.quoted.runtime</a></div><div><a href="../../api/scala/ref.html">scala.ref</a></div><div><a href="../../api/scala/reflect.html">scala.reflect</a></div><div><a href="../../api/scala/reflect/macros.html">scala.reflect.macros</a></div><div><a href="../../api/scala/runtime.html">scala.runtime</a></div><div><a href="../../api/scala/runtime/java8.html">scala.runtime.java8</a></div><div><a href="../../api/scala/sys.html">scala.sys</a></div><div><a href="../../api/scala/sys/process.html">scala.sys.process</a></div><div><a href="../../api/scala/util.html">scala.util</a></div><div><a href="../../api/scala/util/control.html">scala.util.control</a></div><div><a href="../../api/scala/util/hashing.html">scala.util.hashing</a></div><div><a href="../../api/scala/util/matching.html">scala.util.matching</a></div></div></div></nav></div><div id="main"><div id="leftToggler"><span class="icon-toggler"></span></div><div id="searchBar"></div><main>
  <div id="content" pageIds="docs.contributing.debugging.md////PointingToDeclaration//-1753285236">
    <div class="breadcrumbs"><a href="../index.html">Scala 3</a>/<a href="../Contributing/index.html">Contributing</a>/<a href="">Debugging Techniques</a></div>
<html>
 <head>
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin> 
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css"> 
 </head>
 <body>
  <div id="content-wrapper"> 
   <main class="container"> 
    <header> 
     <h1>Debugging Techniques</h1> 
     <div class="byline"> <a href="https://github.com/lampepfl/dotty/edit/master/docs/docs/contributing/debugging.md"> <i class="far fa-edit"></i> Edit this page on GitHub </a> 
     </div> 
    </header> 
    <h1><a href="#debugging-techniques" id="debugging-techniques" class="anchor"></a>Debugging Techniques</h1> 
    <ul> 
     <li><a href="#setting-up-the-playground">Setting up the playground</a></li> 
     <li><a href="#show-for-human-readable-output">Show for human readable output</a></li> 
     <li><a href="#how-to-disable-color">How to disable color</a></li> 
     <li><a href="#reporting-as-a-non-intrusive-println">Reporting as a non-intrusive println</a></li> 
     <li><a href="#printing-out-trees-after-phases">Printing out trees after phases</a></li> 
     <li><a href="#printing-out-stack-traces-of-compile-time-errors">Printing out stack traces of compile time errors</a></li> 
     <li><a href="#configuring-the-printer-output">Configuring the printer output</a></li> 
     <li><a href="#figuring-out-an-object-creation-site">Figuring out an object creation site</a> 
      <ul> 
       <li><a href="#via-id">Via ID</a></li> 
       <li><a href="#via-tracer">Via tracer</a></li> 
      </ul> </li> 
     <li><a href="#built-in-logging-architecture">Built-in Logging Architecture</a> 
      <ul> 
       <li><a href="#printers">Printers</a></li> 
       <li><a href="#tracing">Tracing</a></li> 
       <li><a href="#reporter">Reporter</a></li> 
      </ul> </li> 
    </ul> 
    <p><small><i><a href="http://ecotrust-canada.github.io/markdown-toc/">Table of contents generated with markdown-toc</a></i></small></p> 
    <h2><a href="#setting-up-the-playground" id="setting-up-the-playground" class="anchor"></a>Setting up the playground</h2> 
    <p>Consider the <code>../issues/Playground.scala</code> (relative to the Dotty directory) file is:</p> 
    <pre><code class="language-scala">object Playground {
  def main(args: Array[String]) = {
    println("Hello World")
  }
}
</code></pre> 
    <p>Then, you can debug Dotty by compiling this file via <code>scalac ../issues/Playground.scala</code> (from the SBT console) and collecting various debug output in process. This section documents techniques you can use to collect the debug info.</p> 
    <p><a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/typer/Typer.scala#L2231">This</a> is the entry point to the Typer. The job of the Typer is to take an untyped tree, compute its type and turn it into a typed tree by attaching the type information to that tree. We will use this entry point to practice debugging techniques. E.g.:</p> 
    <pre><code class="language-scala">  def typed(tree: untpd.Tree, pt: Type, locked: TypeVars)(implicit ctx: Context): Tree =
    trace(i"typing $tree", typr, show = true) {
      println("Hello Debug!")
      /*...*/
</code></pre> 
    <p>Then:</p> 
    <pre><code class="language-shell">scalac ../issues/Playground.scala
</code></pre> 
    <p>The techniques discussed below can be tried out in place of <code>println("Hello Debug")</code> in that location. They are of course applicable throughout the codebase.</p> 
    <h2><a href="#show-for-human-readable-output" id="show-for-human-readable-output" class="anchor"></a>Show for human readable output</h2> 
    <p>Many objects in the compiler have a <code>show</code> method available on them via implicit rich wrapper:</p> 
    <pre><code class="language-scala">println(tree.show)
</code></pre> 
    <p>This will output every single tree passing through the typer (or wherever else you inject it) in a human readable form. Try calling <code>show</code> on anything you want to be human-readable, and chances are it will be possible to do so.</p> 
    <h2><a href="#how-to-disable-color" id="how-to-disable-color" class="anchor"></a>How to disable color</h2> 
    <p>Note that the <code>show</code> command above outputs the code in color. This is achieved by injecting special characters into the strings which terminals interpret as commands to change color of the output. This however may not be what you want, e.g. if you want to zero-in on a particular tree:</p> 
    <pre><code class="language-scala">if (tree.show == """println("Hello World")""")
  println(s"${tree.show}\n${pt.show}\n${tree.uniqueId}\n===\n")
</code></pre> 
    <p>The intention above is to output an extended debug info on a tree that matches a particular human-readable representation. However, because of the color characters, the comparison will fail.</p> 
    <p>To disable color output from <code>show</code>, run <code>scalac</code> as follows:</p> 
    <p><code>scalac -color:never ../issues/Playground.scala</code></p> 
    <h2><a href="#reporting-as-a-non-intrusive-println" id="reporting-as-a-non-intrusive-println" class="anchor"></a>Reporting as a non-intrusive println</h2> 
    <p>Consider you want to debug the <code>tree</code> that goes into <code>assertPositioned(tree)</code> in the <code>typed</code> method. You can do:</p> 
    <pre><code class="language-scala">println(tree.show)
assertPositioned(tree)
</code></pre> 
    <p>But you can also do:</p> 
    <pre><code class="language-scala">assertPositioned(tree.reporting(s"Tree is: $result"))
</code></pre> 
    <p><code>extension (a: A) def reporting(f: WrappedResult[T] ?=&gt; String, p: Printer = Printers.default): A</code> is defined on all types. The function <code>f</code> can be written without the argument since it is a context function<code>. The</code>result<code>variable is a part of the</code>WrapperResult<code>– a tiny framework powering the</code>reporting<code>function. Basically, whenever you are using</code>reporting<code>on an object</code>A<code>, you can use the</code>result: A<code>variable from this function and it will be equal to the object you are calling</code>reporting` on.</p> 
    <h2><a href="#printing-out-trees-after-phases" id="printing-out-trees-after-phases" class="anchor"></a>Printing out trees after phases</h2> 
    <p>To print out the trees you are compiling after the FrontEnd (scanner, parser, namer, typer) phases:</p> 
    <pre><code class="language-shell">scalac -Xprint:typer ../issues/Playground.scala
</code></pre> 
    <p>To print out the trees after Frontend and CollectSuperCalls phases:</p> 
    <pre><code class="language-shell">scalac -Xprint:typer,collectSuperCalls ../issues/Playground.scala
</code></pre> 
    <p>To print out the trees after all phases:</p> 
    <pre><code class="language-shell">scalac -Xprint:all ../issues/Playground.scala
</code></pre> 
    <p>To find out the list of all the phases and their names, check out <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/Compiler.scala#L34">this</a> line in <code>Compiler.scala</code>. Each <code>Phase</code> object has <code>phaseName</code> defined on it, this is the phase name.</p> 
    <h2><a href="#printing-out-stack-traces-of-compile-time-errors" id="printing-out-stack-traces-of-compile-time-errors" class="anchor"></a>Printing out stack traces of compile time errors</h2> 
    <p>You can use the flag <code>-Ydebug-error</code> to get the stack trace of all the compile-time errors. Consider the following file:</p> 
    <pre><code class="language-scala">object Foo
object Foo
</code></pre> 
    <p>Clearly we cannot define an object <code>Foo</code> twice. Now compile it as follows: <code>scalac -Ydebug-error ../issues/Playground.scala</code> (use whatever path you saved it under). The result will be as follows:</p> 
    <pre><code class="language-scala">-- Error: ../issues/Playground.scala:2:0 ---------------------------------------
2 |object Foo
  |^
  |object Foo has already been compiled once during this run
java.lang.Thread.getStackTrace(Thread.java:1552)
dotty.tools.dotc.reporting.Reporting.error(Reporter.scala:139)
dotty.tools.dotc.core.Contexts$Context.error(Contexts.scala:71)
dotty.tools.dotc.typer.Namer.errorName$2(Namer.scala:300)
dotty.tools.dotc.typer.Namer.checkNoConflict$1(Namer.scala:306)
dotty.tools.dotc.typer.Namer.createSymbol(Namer.scala:353)
dotty.tools.dotc.typer.Namer.recur$1(Namer.scala:490)
dotty.tools.dotc.typer.Namer.recur$3$$anonfun$2(Namer.scala:495)
...
</code></pre> 
    <p>So, the error happened in the Namer's <code>checkNoConflict</code> method (after which all the stack frames represent the mechanics of issuing an error, not an intent that produced the error in the first place).</p> 
    <h2><a href="#configuring-the-printer-output" id="configuring-the-printer-output" class="anchor"></a>Configuring the printer output</h2> 
    <p>Printing from the <code>show</code> and <code>-Xprint</code> is done from the Printers framework (discussed in more details below). The following settings influence the output of the printers:</p> 
    <pre><code class="language-scala">val printLines        = BooleanSetting("-print-lines"        , "Show source code line numbers.") withAbbreviation "--print-lines"
val uniqid            = BooleanSetting("-uniqid"             , "Uniquely tag all identifiers in debugging output.") withAbbreviation "--unique-id"
val XprintInline      = BooleanSetting("-Xprint-inline"      , "Show  where inlined code comes from")
val XprintTypes       = BooleanSetting("-Xprint-types"       , "Print tree types (debugging option).")
val Ydebug            = BooleanSetting("-Ydebug"             , "Increase the quantity of debugging output.")
val YdebugFlags       = BooleanSetting("-Ydebug-flags"       , "Print all flags of definitions")
val YdebugMissingRefs = BooleanSetting("-Ydebug-missing-refs", "Print a stacktrace when a required symbol is missing")
val YdebugNames       = BooleanSetting("-Ydebug-names"       , "Show internal representation of names")
val YdebugPos         = BooleanSetting("-Ydebug-pos"         , "Show full source positions including spans")
val YdebugTrace       = BooleanSetting("-Ydebug-trace"       , "Trace core operations")
val YdebugTreeWithId  = IntSetting    ("-Ydebug-tree-with-id", "Print the stack trace when the tree with the given id is created", Int.MinValue)
val YprintDebug       = BooleanSetting("-Yprint-debug"       , "when printing trees, print some extra information useful for debugging.")
val YprintDebugOwners = BooleanSetting("-Yprint-debug-owners", "when printing trees, print owners of definitions.")
val YprintPos         = BooleanSetting("-Yprint-pos"         , "show tree positions.")
val YprintPosSyms     = BooleanSetting("-Yprint-pos-syms"    , "show symbol definitions positions.")
val YprintSyms        = BooleanSetting("-Yprint-syms"        , "when printing trees print info in symbols instead of corresponding info in trees.")
val YshowTreeIds      = BooleanSetting("-Yshow-tree-ids"     , "Uniquely tag all tree nodes in debugging output.")
val YshowVarBounds    = BooleanSetting("-Yshow-var-bounds"   , "Print type variables with their bounds")
val YtestPickler      = BooleanSetting("-Ytest-pickler"      , "self-test for pickling functionality; should be used with -Ystop-after:pickler")
</code></pre> 
    <p>They are defined in <a href="https://github.com/lampepfl/dotty/blob/master/compiler/src/dotty/tools/dotc/config/ScalaSettings.scala">ScalaSettings.scala</a>. E.g. <code>YprintPos</code> is defined as:</p> 
    <pre><code class="language-scala">val YprintPos: Setting[Boolean] = BooleanSetting("-Yprint-pos", "show tree positions.")
</code></pre> 
    <p>And is to be used as:</p> 
    <pre><code class="language-scala">scalac -Yprint-pos  ../issues/Playground.scala
</code></pre> 
    <p>If used, all the trees output with <code>show</code> or via <code>-Xprint:typer</code> will also have positions attached to them, e.g.:</p> 
    <pre><code class="language-scala">package &lt;empty&gt;@&lt;Playground.scala:1&gt; {
  module object Playground {
    def main(
      args:
        Array@&lt;Playground.scala:2&gt;[String@&lt;Playground.scala:2&gt;]@&lt;
          Playground.scala:2
        &gt;
      @&lt;Playground.scala:2&gt;
    ) =
      {
        println@&lt;Playground.scala:3&gt;("Hello World"@&lt;Playground.scala:3&gt;)@&lt;
          Playground.scala:3
        &gt;
      }@&lt;Playground.scala:2&gt;
    @&lt;Playground.scala:2&gt;
  }@&lt;Playground.scala:1&gt;
}@&lt;Playground.scala:1&gt;
&lt;empty&gt;@&lt;Playground.scala:1&gt;
</code></pre> 
    <h2><a href="#figuring-out-an-object-creation-site" id="figuring-out-an-object-creation-site" class="anchor"></a>Figuring out an object creation site</h2> 
    <h3><a href="#via-id" id="via-id" class="anchor"></a>Via ID</h3> 
    <p>Every <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/ast/Positioned.scala">Positioned</a> (a parent class of <code>Tree</code>) object has a <code>uniqueId</code> field. It is an integer that is unique for that tree and doesn't change from compile run to compile run. You can output these IDs from any printer (such as the ones used by <code>.show</code> and <code>-Xprint</code>) via <code>-Yshow-tree-ids</code> flag, e.g.:</p> 
    <pre><code class="language-shell">scalac -Xprint:typer -Yshow-tree-ids  ../issues/Playground.scala
</code></pre> 
    <p>Gives:</p> 
    <pre><code class="language-scala">package &lt;empty&gt;#1047 {
  final lazy module val Playground: Playground$#1049 =
    new Playground$#1049#1050#1051()#1052
  #1053
  final module class Playground$() extends Object#1090#1091#1092()#1093, _root_#
    1061
  .scala#1062.Serializable#1063 { this: Playground#1054.type#1055 =&gt;
    def main(args: Array#1028[String#1033]#1034#1038): Unit#1039 =
      {
        println#1094("Hello World"#1041)#1095
      }#1096
    #1097
  }#1099
}#1100
</code></pre> 
    <p>You can then use these IDs to locate the creation site of a given tree using that ID via <code>-Ydebug-tree-with-id</code>, e.g.:</p> 
    <pre><code class="language-shell">scalac -Ydebug-tree-with-id 1049 ../issues/Playground.scala
</code></pre> 
    <p>When the tree with the correspond id is allocated, the following prompt will appear:</p> 
    <pre><code>Debug tree (id=1049) creation
Ident(Playground$)


a)bort, s)tack, r)esume
</code></pre> 
    <p>If you input <code>s</code>, you will get a stack trace like this:</p> 
    <pre><code>java.lang.Throwable
  at dotty.tools.dotc.reporting.Reporter$.loop$1(Reporter.scala:55)
  at dotty.tools.dotc.reporting.Reporter$.displayPrompt(Reporter.scala:63)
  at dotty.tools.dotc.ast.Positioned.printTrace$1(Positioned.scala:32)
  at dotty.tools.dotc.ast.Positioned.uniqueId_$eq(Positioned.scala:34)
  at dotty.tools.dotc.ast.Positioned.&lt;init&gt;(Positioned.scala:45)
  at dotty.tools.dotc.ast.Trees$Tree.&lt;init&gt;(Trees.scala:53)
  at dotty.tools.dotc.ast.Trees$DenotingTree.&lt;init&gt;(Trees.scala:266)
  at dotty.tools.dotc.ast.Trees$NameTree.&lt;init&gt;(Trees.scala:292)
  at dotty.tools.dotc.ast.Trees$RefTree.&lt;init&gt;(Trees.scala:298)
  at dotty.tools.dotc.ast.Trees$Ident.&lt;init&gt;(Trees.scala:375)
  at dotty.tools.dotc.ast.untpd$.Ident(untpd.scala:301)
  at dotty.tools.dotc.ast.desugar$.moduleDef(Desugar.scala:804)
  at dotty.tools.dotc.ast.desugar$.defTree(Desugar.scala:1038)
  at dotty.tools.dotc.typer.Namer.expand(Namer.scala:441)
  at dotty.tools.dotc.typer.Namer.index$$anonfun$1(Namer.scala:722)
  at dotty.runtime.function.JProcedure1.apply(JProcedure1.java:15)
  at dotty.runtime.function.JProcedure1.apply(JProcedure1.java:10)
  at scala.collection.immutable.List.foreach(List.scala:392)
  at dotty.tools.dotc.typer.Namer.index(Namer.scala:722)
  at dotty.tools.dotc.typer.Namer.recur$1(Namer.scala:484)
  at dotty.tools.dotc.typer.Namer.indexExpanded(Namer.scala:501)
  at dotty.tools.dotc.typer.Namer.index(Namer.scala:474)
  at dotty.tools.dotc.typer.FrontEnd.enterSyms$$anonfun$1(FrontEnd.scala:69)
  at dotty.runtime.function.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
  at dotty.tools.dotc.typer.FrontEnd.monitor(FrontEnd.scala:41)
  at dotty.tools.dotc.typer.FrontEnd.enterSyms(FrontEnd.scala:71)
  at dotty.tools.dotc.typer.FrontEnd.runOn(FrontEnd.scala:100)
  at dotty.tools.dotc.Run.runPhases$4$$anonfun$4(Run.scala:158)
  at dotty.runtime.function.JProcedure1.apply(JProcedure1.java:15)
  at dotty.runtime.function.JProcedure1.apply(JProcedure1.java:10)
  at scala.collection.IndexedSeqOptimized.foreach(IndexedSeqOptimized.scala:36)
  at scala.collection.IndexedSeqOptimized.foreach$(IndexedSeqOptimized.scala:33)
  at scala.collection.mutable.ArrayOps$ofRef.foreach(ArrayOps.scala:198)
  at dotty.tools.dotc.Run.runPhases$5(Run.scala:170)
  at dotty.tools.dotc.Run.compileUnits$$anonfun$1(Run.scala:178)
  at dotty.runtime.function.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:12)
  at dotty.tools.dotc.util.Stats$.maybeMonitored(Stats.scala:102)
  at dotty.tools.dotc.Run.compileUnits(Run.scala:185)
  at dotty.tools.dotc.Run.compileSources(Run.scala:120)
  at dotty.tools.dotc.Run.compile(Run.scala:104)
  at dotty.tools.dotc.Driver.doCompile(Driver.scala:34)
  at dotty.tools.dotc.Driver.process(Driver.scala:172)
  at dotty.tools.dotc.Driver.process(Driver.scala:141)
  at dotty.tools.dotc.Driver.process(Driver.scala:153)
  at dotty.tools.dotc.Driver.main(Driver.scala:180)
  at dotty.tools.dotc.Main.main(Main.scala)
</code></pre> 
    <p>So that tree was created at:</p> 
    <pre><code>  at dotty.tools.dotc.ast.desugar$.moduleDef(Desugar.scala:804)
</code></pre> 
    <p>Since all the stack frames above it are technical frames executing the tree creation command, and the frame in question is the location where the intent of the tree creation was expressed.</p> 
    <h3><a href="#via-tracer" id="via-tracer" class="anchor"></a>Via tracer</h3> 
    <p>Some objects may not be <code>Positioned</code> and hence their creation site is not debuggable via the technique in the section above. Say you target a tree at <code>Typer</code>'s <code>typed</code> method as follows:</p> 
    <pre><code class="language-scala">if (tree.show == """println("Hello World")""") {
  val creationSite = "&lt;creation site stack here&gt;"
  println(creationSite)
}
</code></pre> 
    <p>In other words, you have a reference to the object and want to know were it was created. To do so, go to the class definition of that object. In our case, <code>tree</code> is a <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/ast/Trees.scala#L52"><code>Tree</code></a>. Now, create a new <code>val</code> member of that type:</p> 
    <pre><code class="language-scala">val tracer = Thread.currentThread.getStackTrace.mkString("\n")
</code></pre> 
    <p>Then, from the <code>typed</code> method (or wherever you want to access the trace):</p> 
    <pre><code class="language-scala">if (tree.show == """println("Hello World")""") {
  val creationSite = tree.tracer
  println(creationSite)
}
</code></pre> 
    <h2><a href="#built-in-logging-architecture" id="built-in-logging-architecture" class="anchor"></a>Built-in Logging Architecture</h2> 
    <p>Dotty has a lot of debug calls scattered throughout the code, most of which are disabled by default. At least three (possibly intertwined) architectures for logging are used for that:</p> 
    <ul> 
     <li>Printer</li> 
     <li>Tracing</li> 
     <li>Reporter</li> 
    </ul> 
    <p>These do not follow any particular system and so probably it will be easier to go with <code>println</code> most of the times instead.</p> 
    <h3><a href="#printers" id="printers" class="anchor"></a>Printers</h3> 
    <p>Defined in <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/config/Printers.scala">Printers.scala</a> as a set of variables, each responsible for its own domain. To enable them, replace <code>noPrinter</code> with <code>default</code>. <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/typer/Typer.scala#L2226">Example</a> from the code:</p> 
    <pre><code class="language-scala">typr.println(i"make contextual function $tree / $pt ---&gt; $ifun")
</code></pre> 
    <p><code>typr</code> is a printer.</p> 
    <h3><a href="#tracing" id="tracing" class="anchor"></a>Tracing</h3> 
    <p>Defined in <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/reporting/trace.scala">trace.scala</a>. <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/typer/Typer.scala#L2232">Example</a> from the code:</p> 
    <pre><code class="language-scala">trace(i"typing $tree", typr, show = true) { // ...
</code></pre> 
    <p>To enable globally, change <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/config/Config.scala#L164">tracingEnabled</a> to <code>true</code> (will recompile a lot of code).</p> 
    <p>You also need to set the printer referenced in the call (in the example, <code>typr</code>) to <code>default</code> as explained in the section on printers.</p> 
    <p>To enable for a single trace, do the following:</p> 
    <pre><code class="language-scala">trace.force(i"typing $tree", typr, show = true) { // ...
</code></pre> 
    <h3><a href="#reporter" id="reporter" class="anchor"></a>Reporter</h3> 
    <p>Defined in <a href="https://github.com/lampepfl/dotty/blob/10526a7d0aa8910729b6036ee51942e05b71abf6/compiler/src/dotty/tools/dotc/reporting/Reporter.scala">Reporter.scala</a>. Enables calls such as <code>report.log</code>. To enable, run scalac with <code>-Ylog:typer</code> option.</p> 
   </main> 
  </div> 
  <script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'lampepfl/dotty'
  };
</script> 
  <script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>
 </body>
</html>  </div>
</main><footer><span class="go-to-top-icon"><a href="#container"><span class="icon-vertical_align_top"></span>&nbsp;Back to top</a></span>Generated by&nbsp;<a href="https://github.com/lampepfl/dotty/tree/master/scala3doc"><img src="../../images/scala3doc_logo.svg" alt="Scala3doc" class="scala3doc_logo"></img></a></footer></div></div><script type="text/javascript" src="../../scripts/pages.js"></script><script type="text/javascript" src="../../scripts/main.js"></script></body></html>
